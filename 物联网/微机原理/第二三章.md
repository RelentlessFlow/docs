# 第二章 微型计算机基础

## 2.1 指令系统

一、程序设计语言大致可分为机器语言、汇编语言和高级语言。

二、计算机把预先存入存储器中的指令一条条取出来，加以翻译和执行的这一系列的命令的集合就是计算机程序。

三、指令就是计算机要执行的某种操作的明令，程序就是一组指令的有序集合。指令是设计一套计算机的硬件与底层软件的借口。

四、指令由指令操作码和操作数组成，指令操作码规定指令的操作类型，操作数规定指令的操作对象。

五、由机器指令构成的语言，称为机器语言。汇编语言与机器语言的指令是一一对应的，它也是面向机器的语言。

六、通过汇编程序自动翻译成机器语言，这个过程称为汇编。

七、算法语言编写的源程序，必须通过编译程序或解释程序翻译为机器语言。编译程序可把源程序翻译成目标程序，目标程序一般不能独立运行，还需要一种称之为运行系统 的辅助程序来帮助。通常，把编译程序和运行系统合称为编译系统。

八、CISC复杂指令集，RISC精简指令集。

## 2.2 微型计算机系统结构

一、微型计算机是以微处理器为核心，配上内存储器，输入输出电流及系统总线所组成的计算机。

二、微型计算机系统是以微型计算机为中心，配以相应的外围设备，电源，辅助电路，以及控制微型计算机工作的系统软件所构成的计算机系统。

**三、冯诺依曼体系结构：**

	1. **计算机由运算器、存储器、控制器、输入输出和输出设备五大设备所组成；**
	2. 指令和数据存储在存储器中，并可以按地址访问；
	3. **指令由操作码和地址码构成，操作码指明操作的性质，地址码表示操作数在存储器中的位置；**
	4. 指令在存储器内按顺序存放，通常按自动的顺序取出执行；
	5. **机器以运算器为中心，I/O设备与存储器交换数据也要通过运算器。**
	6. **指令和数据均以二进制表示；**

四、控制器是根据存放在存储器中的指令序列来操作的，并由一个程序计数器控制指令的执行。

五、运算器用来完成算数运算和逻辑运算。运算的核心是算数逻辑运算单元，简称ALU。

六、控制器包括指令寄存器、指令译码器和时序控制器等组成。

七、系统总线分为数据总线、地址总线和控制总线。

**八、数据总线**是**双向三态**的信号线，16位微机系统的数据总线宽度为16位，它决定了**处理器的字长**。

​		8086CPU内部的**数据总线**有**16**条。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

**九、地址总线的位数决定了系统所能直接访问的存储空间的容量。**16位地址总线，可直接寻址的空间位64KB。20位地址总线，可直接寻址1MB的存储空间。

十、CPU中由六类寄存器：指令寄存器IR、程序计数器PC、地址寄存器AR、数据寄存器DR、通用寄存器、程序状态寄存器PSW。

十一、程序状态寄存器PSW用来存放运算状态条件，借位标志C，运算结果溢出O，运算结果零Z，运算结果负N，运算结果符号标志S

十二、主机与外围设备之间的信息传送控制方式，按照发展的先后和主机与外设并行的程度，分为5种：

 1. 程序查询方式

    在一次数据传送之前，CPU首先检查外设是否“准备好”。

	2. 中断控制方式

    所谓中断控制，就是外围设备用来主动通知CPU，报告它是否已进入准备就绪状态。

	3. 直接存储器存取控制方式

    直接存储器存取DMA是一种完成由硬件执行I/O交换的方式。

    DMA控制器从CPU完全接管对总线的控制，数据交换不经过CPU，而直接在内存和外围设备之间进行。

	4. 通道方式

    通过增加一个具有特性功能的诸如输入输出处理器的硬件来分担CPU的一部分功能，实现对外围设备的统一管理。

	5. 外围处理器方式

    外围处理器PPU，是通道方式的进一步发展，它更接近于一般的处理器。

十三、程序中断思想：当CPU需要一次I/O操作数时，就启动外设工作，这时CPU继续执行原来的程序，外设和CPU共同工作，而不是像程序查询方式那样让CPU原地等待。当外设的数据准备就绪或完成操作时，它就通过I/O接口“主动”向CPU发送请求中断的信号，请求CPU暂时中断目前正在执行的程序而进行数据交换。当CPU相应这个中断时，便暂停运行正在执行的程序（通常称为主程序），转去执行I/O操作程序（称为中断服务子程序或中断处理子程序），当中断服务程序结束之后，CPU返回被暂时中止的程序继续执行，也就是说，在当前执行的主程序中插进了一段别的程序——中断服务子程序，通过它完成I/O信息转换。

十四、能够引发中断的事件称为中断源。

十五、中断的过程包括中断请求、中断相应、中断处理和中断返回。

十六、CPU采用分段方式管理内存，每个段最大64K。

十七、8086最大I/0，64K。

十七、指令指针IP中存放的是指令地址。

十八、8086对外部请求响应最高的是READY。

十九、8284 时钟处理器	822总线处理器（总线控制源）	8287运算处理器	8289 I/0处理器，属于总线总裁器

二十、8086决定通道所有权。

二十一、8086最小典型配置中，需2片双向总线收发器8286.

二十二、8086最小工作方式下有关总线请求的信号引脚是HDLD和HIOA。

二十三、8086存储器分段，每个段最大64K，最小16K。

二十四、8086中EU和BUI是并行执行的。

二十五、什么是最小工作模式？什么是最大工作模式？

​			8086控制所有信号。8086需配合8089、8087等协处理器完成多处理器系统。

# 第三章 8086微处理器

## 3.1 8086微处理器

一、8086是Intel公司于1978年出品的16位微处理器，是第三代处理器，具有20位地址总线，直接寻址能力达1MB，具有16位数据总线，内部总线和ALU均为16位。

二、8086CPU、8087浮点运算器及8089 I/O处理器组成的多处理器系统

## 3.2 8086寻址空间

一、寻址空间是由CPU地址总线的位数决定的，地址总线20位，寻址能力为2^10=1MB，20386地址总线为32位，CPU的寻址能力为为4GB。

二、8086地址总线20位，寻址能力1MB，寻址范围用十六进制表示位00000H～FFFFFH。这种每个字节对应给地址的方式称为按字节编址。

三、字节数据（BYTE）变量可以是字节、字双字类型。字节数据是8位，对应的数据可以是偶地址A0=0也可以是奇地址A0=1。

四、字数据(WORD)，8086是16位机，字长16位，每个字节数据存放在连续两个连续的字节单元中，高8位存放在高地址字节，称为高字节，低8位存放在低地址字节，称为低字节，规定低字节的地址作为这个字的地址（字地址）。若该字地址位于偶地址，即低字节地址为偶数，称为规则字，否则为非规则字。双字数据占用4个连续字节但愿，并规定最低字节地址为双字的地址。

五、高位字节块利用BHE 信号作为该块的选择信号;低位字节块利用地址线 A0=0(低电平)作为该块的选择信号。

![image-20210221095212808](https://md-1304276643.cos.ap-beijing.myqcloud.com//PicGo/image-20210221095212808.png)

六、8086 CPU 的 20 位地址线，可直接寻址 1MB/存储器物理空间，其地址范围为 00000H~FFEFFH，与存储单元一一对应的 20 位地址，称为存储单元的物理地址。

七、通过对内存的分段，将 20 位的物理地址用 1 个 16 位的段地 址和 1 个 16 位的偏移地址组成的逻辑地址表示。公式：物理地址=段地址x10H+偏移地址。

​			  物理地址=段地址×16 十偏移地址

例如，逻辑地址 7018:FE7F 表示的物理地址是 7018H×10H+FE7FH=7FFFFH。

八、8086 CPU 由一个专门的 20 位地址加法器实现逻辑地址到物理地址的变换。

<img src="https://md-1304276643.cos.ap-beijing.myqcloud.com//PicGo/image-20210221105250751.png" alt="image-20210221105250751" style="zoom:50%;" />

## 3.3 8086/8088 微处理器

一、8086结构设计图：

![image-20210221111704457](https://md-1304276643.cos.ap-beijing.myqcloud.com//PicGo/image-20210221111704457.png)

![image-20210221112107232](https://md-1304276643.cos.ap-beijing.myqcloud.com//PicGo/image-20210221112107232.png)数据寄存器：AX:累加器 BX:基址寄存器 CX:计数器 DX:数据存储器

段寄存器：CS代码段寄存器数据	DS段寄存器堆	SS栈段寄存器	ES附加段数据寄存器

CS：存放代码段段基值，偏移地址IP提供。

DS：数据段的段基值

SS： 当前段的底部地址，存档堆栈段的段基值

ES：附加数据段的段基值，串操作指令目的串所在的串。

SP：存档栈顶地址，入栈和出栈由SP给出偏移地址。

BP：存档堆栈段的起始位置

IP：用来存放下一条要执行指令在代码段中的偏移地址，程序员不可以直接使用，但程序控制类指令会用到。它具有自动加 l 功能，每当执行一次取指令操作，它将自动加 1， 总是指向下一条要取的指令在现行代码段中的偏移地址。它和 CS 相结合，形成指向指 令存放单元的物理地址。

FLAGS：它是 16 位的寄存器，但实际上 8086 只用到 9 位，其中的 6 位是状态标志位，3 位 为控制标志位。

![image-20210221113040801](https://md-1304276643.cos.ap-beijing.myqcloud.com//PicGo/image-20210221113040801.png)

DF 是方向标志位。用于串操作指令，指定字符串处理时的方向。如设置 DF=0时，那么每执行一次串操作指令.地址指针内容将自动递增;设置 DF=l 时，地址指针 内容将自动递减。可用指令设置或清除 DF 位。

IF 是中断允许标志位。用来控制 8086 是否允许接收外部中断请求。

设置 IF=l，则允许响应可屏蔽中断请求;设置IF= 时，禁止响应可屏蔽中断请求。

可用指令设置或清除IF位。注意，IF的状态不影响非屏蔽中断请求(NMI)和 CPU 内部中断请求。

TF 是单步标志位。它是为调试程序而设定的陷阱控制位。如设置 TF=l，使 CPU 进入单步执行指令工作方式，则此时 CPU 每执行完一条指令就自动产生一次内部中断。 当该位复位后，CPU 恢复正常工作。可用指令设置或清除 TF 位。

二、8086时钟周期：

执行指令的一系列操作都是在时钟脉冲 CLK 的统一控制下逐步进行的，一个时钟脉冲时间称为一个时钟周期。时钟周期由计算机的主频决定，是 CPU 的定时基准，例 如 8086 的主频为 5MHz，则 1 个时钟为 200ns。

8086 CPU 与外部交换信息总是通过总线进行的。CPU 从存储器或外设存取一个字 节或字所需的时间称为总线周期。一个基本的总线周期由 4 个时钟周期组成，分别称为 T1、T2、T3 和 T4 时钟周期或 T 状态。

一个总线周期完成一次数据传输，至少要有传送地址和传送数据两个过程。在第一 个时钟周期 T1 期间由 CPU 输出地址，在随后的 3 个 T 周期(T2、T3 和 T4)期间用以传送 数据。换言之，数据传送必须在 T2~T4 这 3 个周期内完成，否则在 T4 周期后，总线将 进行另一次操作，开始下一个总线周期。

被选中进行数据读写的存储器或外设无法在 3 个 T 周期内完成数据读写时，就 由其发出一个请求延长总线周期的信号到 8086 CPU 的 READY 引脚，8086 CPU 收到 该请求后,就在 T3 和 T4 之间插入一个等待周期 TW，加入 TW 的个数与外部请求信号的 持续时间长短有关，延长的时间 TW 也以时钟周期 T 为单位，在 TW 期间，总线上的状 态一直保持不变。

如果在一个总线周期后不立即执行下一个总线周期，即总线上无数据传输操作，系 统总线处于空闲状态，则这时执行空闲周期 Ti，

三、8086 微处理器的时序：时钟周期、总线周期和指令周期。

四、8086引脚功能：

<img src="https://md-1304276643.cos.ap-beijing.myqcloud.com//PicGo/image-20210221143945496.png" alt="image-20210221143945496" style="zoom:40%;" />

AD15~AD0：地址/数据总线 双向三态

A19/S6~A16/S3：地址/状态总线 输出/三态

BHE/S7：总线高允许/状态。当BHE =0 时， 表示高 8 位数据总线 AD15~AD8 上的数据有效;当BHE =l 时，表示高 8 位数据总线 AD15~AD8 上的数据无效，

INTR 可屏蔽中断请求信号引脚(输入)：INTR 为高电平有效信号。CPU 在每条指令的最后时刻检测 INTR 引脚，若为高电 平，则表明有中断请求发生，若当前 CPU 允许中断(中断允许标志 IF=l)，那么 CPU 就 会在结束当前执行的指令后，响应中断请求，进入中断处理子程序。

NMI 非屏蔽中断引脚(输入)：当 NMI 引脚产生一个由低到高的上升沿时，CPU 就会在结束当前执行的指令后， 进入非屏蔽中断处理子程序。

CLK 时钟引脚(输入)

MN/MX：最小/最大模式控制信号引脚(输入) 最小模式及最大模式的选择控制端。此引脚固定为+5V 时，CPU 处于最小模式，CPU 处于最大模式。

RD读引脚(输出、三态)：RD为高电平有效信号。RD=0 时，表明 CPU 要进行一次内存或 I/O 端口的读操作，

具体是对内存还是I/O端口进行读操作，决定于M/IO信 号。

READY ：READY 是所访问的存储器或 I/O 端口发来的响应信号，高电平有效。当 READY=l

时，表示内存或 I/O 端口准备就绪，马上可进行一次数据传输。

TEST：TEST 为低电平有效信号，和 WAIT 指令结合使用，是 WAIT 指令结束与否的条件。

HOLD 总线保持请求信号(输入)：HOLD 是系统中其他模块向 CPU 提出总线保持请求的输入信号，高电平有效。 HLDA 总线保持响应信号(输出)：HLDA 是 CPU 发给总线请求部件的响应信号，高电平有效。





# 习题

## 一、灵活题

一、8088/8086 的存储器组织是将存储器划分为段，可作为段的起始地址的是( )。**B**

A.185A2H B.00020H C.01003H D.OAB456H

`可以作为段的起始地址：   逻辑段的开始地址必须是16的倍数，因为段寄存器长为16位。`

二、设定某数据区为 16 个字，起始地址为 70A0:DDE6，该数据区数据字的首末物理 地址分别是**7E7E6H**和**7E804H**。

`首物理地址=段基地址*10H+偏移地址	末地址=首地址+数据总长度，这个题是7E7E6H+(16D-1D)x2D=7E7E6H+1EH=7E80H`

三、设堆栈段寄存器 ss 所存放的数据为 2250H，堆栈指示器 SP 所存放的数据为 0140H， 如压入堆栈 7 个数据库字，问栈顶地址、SS 和 SP 各为________、________、________。	22640H（之前）**22632H（之后）	2250H	0132H**

```
这个题就是SS寸的是栈基地址，SP寸偏移地址，压入之前物理地址就是2250H*10H+0140H=22640H。
压入之后是减去所压入的数字（堆栈是越来越高的），7个数据库字，也就是14个空间，14个空间转16进制也就是EH，然后140H减去EH，也就是132H。
```

四、8086执行指令MOV AL,【BX】，其中(BX)=1023H时，(BHE)和A0的输出是0,1。

```
如果操作数是字节，奇数是01,偶数是10
```



## 二、死题

### 填空选择

一、8086内部的数据总线：16条

二、IBC PC采用分段的方式管理内存，每个段最大可达64KB字节。

三、8086可以访问最大IO空间为64KB

四、IP存指令地址，SS存栈基地址，SP存堆栈段偏移地址。

五、如果访问存储器时**采用BP寻址**，默认的**段寄存器是SS**。

六、8086对外部请求响应**优先级最高**的是**READY**。

七、8086经过加电复位后，执行第一条指令的地址是FFF0H。(CS=FFFFH,IP=0000H)

八、8284 时钟处理器	822总线处理器（总线控制源）	8287运算处理器	8289 I/0处理器（总线总裁器）

九、芯片**8086CPU**具有通道优先权。

十、在8086最小模式的典型配置中，需**2片**双向总线收发器**8286**。

十一、当存储器的读出时间大于CPU所需要的时间时，为了保证存储器与CPU的周期配合就要利用READY信号，使CPU在后**T3**插入一个TW状态。

十二、8086 系统中，存储器分为奇、偶两个存储体。偶体的数据信号线固定与数据总线的**AD0-AD7**相连。

十三、8086在最小方式下有关总线请求的信号引线是**HOLD和HIOA**。

十四、8086执行存储器写时许的时候，IO/M为低电平，DT/R为高电平。

十五、8086CPU的READY信号是由外部硬件产生的。

十六、8086 向存储器的奇地址写一个字节的数据时，需要一个总线周期，在该总线周期

内的第一个时钟周期中，**A0 为 1**。

### 简答

1. 微型计算机系统总线由哪三部分组成?它们各自的功能是什么?

   ```
   数据总线：用来传输duCPU与存储器间、CPU与接zhi口间指令和数据；
   地址总线：用来选择存储器指定单元、指定接口；
   控制总线：用来传送控制信号，时序信号，和状态信息等。其中有的是CPU向dao存和外设发出的信息，有的则是转存和外设向CPU发出的信息。
   ```

2. 什么是最小工作方式?什么是最大工作方式?

   ```
   1.8086控制所有信号。
   2.8086需要配合8089，8087等协处理器构建微型计算机系统。
   ```

3. 8086执行了一个总线周期是指8086做了哪些可能的操作？基本总线周期如何组成？在一个典型的读存储器总线周期中，地址信号、ALE信号、RD信号、数据信号分别在何时产生？

   ```
   (1)“8086/8088 执行了一个总线周期”是指：①8086/8088 可能从片外的存储器取指令； ②8086/8088可能对片外的存储器或 I/O 接口进行了一次读/写数据的操作。
   (2)基本总线周期由 T1 至 T4 四个时钟周期组成。
   (3)在一个典型的读存储器总线周期中，地址信号在 T1 周期内产生，ALE 信号在 T1 周期内产生， RD信号在 T2 周期内产生，数据信号一般在 T3 周期内产生，若存储器在 T3 内来不及提供数据，8086/8088会在总线周期中的 T3 后插入等待状态 Tw，存储器将在某 Tw 中给出数据。
   ```

4. 8086CPU系统中为什么要用地址锁存器？

   ```
   8086CPU 由于引脚数量少,其地址总线采用了分时复用的双重总线(A19-A16/S6-S3 和AD15~AD0以及BHE/S7)(2分)；
   仅在总线周期的 T l 时钟周期输出地址信号，而在整个总线周期中地址信号需保持不变，这就需用地址锁存器将 T1 周期发出的地址信号锁存起来以在整个总线周期中都能使用(3分)；
   ```

5. 8086CPU中的地址加法器的重要性体现在哪？

   ```
   地址加法器是8086CPU的总线接口单元中的一个器件，在8086存储器分段组织方式中它是实现存储器寻址的一个关键器件，地址加法器将两个16位寄存器中的逻辑地址移位相加，得到一个20位的实际地址，把存储器寻址空间从64K扩大到1M，极大地扩大了微型计算机的程序存储空间，从而大大提高了程序运行效率。
   ```